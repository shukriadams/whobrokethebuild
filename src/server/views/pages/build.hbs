{{#extend "layout"}}
    {{#content "body"}}
        <ul class="list build">

            <li class="list-item card">
                <div class="card-status card-status--{{statusTranslate build.status}}"></div>
                <div class="card-content">
                    <h1>Build #{{build.build}}</h1>
                    <p>
                        Ran {{ago build.started}}{{#if build.ended}}, took {{durationLong build.ended build.started}} to complete{{/if}}
                    </p>
                    <p>
                        Built on :  {{build.host}}
                    </p>
                    <p>
                        Job : <a href="/job/{{build.jobId}}">{{job.name}}</a>
                    </p>
                    <p>
                        <a href="{{linkToBuild}}">View on {{ciServer.name}}</a>
                    </p>
                    <p>
                        Status : {{statusTranslate build.status}}{{#if build.delta}}, {{deltaTranslate build.delta}}{{/if}}
                        {{#if responsibleBreakingBuild}}
                            <a href="/build/{{responsibleBreakingBuild.id}}">Broken by {{responsibleBreakingBuild.build}}</a>
                        {{/if}}
                    </p>
                    <p>
                        {{#if previousBuild}}
                            <a href="/build/{{previousBuild.id}}">Previous ({{durationLong build.started previousBuild.started}})</a>
                        {{/if}}

                        {{#if nextBuild}}
                            <div>
                                <a href="/build/{{nextBuild.id}}">Next ({{durationLong nextBuild.started build.started}})</a>
                            </div>
                        {{/if}}
                    </p>
                    {{#if session.isAdmin}}
                        <div>
                            <h2>Admin</h2>
                            <button class="button build-delete" data-id="{{build.id}}">Remove build</button>    
                        </div>
                    {{/if}}
                </div>
            </li>
            
            <li class="list-item build-item">
                <h2>Changes in this build</h2>
                <ul class="list">
                    {{#if build.involvements}}
                        {{#each build.involvements}}
                            <li>
                                <h3>
                                    {{>buildInvolvementUserLink this}} ({{revision}}) 
                                </h3>
                                <div>
                                    <b>
                                        {{buildInvolvementTranslate involvement}}
                                    </b>

                                </div>
                                <i>
                                    {{__revision.description}}
                                </i>
                                <ul>
                                    {{#each __revision.files}}
                                        <li class="revision-file revision-file--{{#if isFault}}atFault{{/if}}">
                                            {{file}}
                                        </li>
                                    {{/each}}
                                </ul>
                            </li>
                        {{/each}}
                    {{else}}
                        <li>
                            There are no revisions in this build
                        </li>
                    {{/if}}
                </ul>

                {{#eq build.status constants.BUILDSTATUS_FAILED}}
                    <h2>Log</h2>
                    <ul class="buildLog">
                        {{#if build.logData}}
                            {{#each build.logData}}
                                <li class="buildLog-item buildLog-item--{{type}}">
                                    {{text}}
                                </li>
                            {{/each}}
                            <li>
                                <a href="/build/log/{{build.id}}">Full log</a>
                            </li>
                        {{else}}
                            <li class="buildLog-item">
                                Log is empty or has not been processed yet
                            </li>
                        {{/if}}
                    </ul>
                {{/eq}}
            </li>
        </ul>

    {{/content}}
{{/extend}}


